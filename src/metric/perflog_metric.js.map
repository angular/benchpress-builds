{"version":3,"file":"perflog_metric.js","sourceRoot":"/home/travis/build/angular/angular/packages/benchpress/","sources":["src/metric/perflog_metric.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Inject, Injectable, InjectionToken} from '@angular/core';\n\nimport {Options} from '../common_options';\nimport {Metric} from '../metric';\nimport {PerfLogEvent, PerfLogFeatures, WebDriverExtension} from '../web_driver_extension';\n\n\n/**\n * A metric that reads out the performance log\n */\n@Injectable()\nexport class PerflogMetric extends Metric {\n  static SET_TIMEOUT = new InjectionToken('PerflogMetric.setTimeout');\n  static PROVIDERS = [\n    {\n      provide: PerflogMetric,\n      deps: [\n        WebDriverExtension, PerflogMetric.SET_TIMEOUT, Options.MICRO_METRICS, Options.FORCE_GC,\n        Options.CAPTURE_FRAMES, Options.RECEIVED_DATA, Options.REQUEST_COUNT\n      ]\n    },\n    {\n      provide: PerflogMetric.SET_TIMEOUT,\n      useValue: (fn: Function, millis: number) => <any>setTimeout(fn, millis)\n    }\n  ];\n\n  private _remainingEvents: PerfLogEvent[];\n  private _measureCount: number;\n  private _perfLogFeatures: PerfLogFeatures;\n\n  /**\n   * @param driverExtension\n   * @param setTimeout\n   * @param microMetrics Name and description of metrics provided via console.time / console.timeEnd\n   **/\n  constructor(\n      private _driverExtension: WebDriverExtension,\n      @Inject(PerflogMetric.SET_TIMEOUT) private _setTimeout: Function,\n      @Inject(Options.MICRO_METRICS) private _microMetrics: {[key: string]: string},\n      @Inject(Options.FORCE_GC) private _forceGc: boolean,\n      @Inject(Options.CAPTURE_FRAMES) private _captureFrames: boolean,\n      @Inject(Options.RECEIVED_DATA) private _receivedData: boolean,\n      @Inject(Options.REQUEST_COUNT) private _requestCount: boolean) {\n    super();\n\n    this._remainingEvents = [];\n    this._measureCount = 0;\n    this._perfLogFeatures = _driverExtension.perfLogFeatures();\n    if (!this._perfLogFeatures.userTiming) {\n      // User timing is needed for navigationStart.\n      this._receivedData = false;\n      this._requestCount = false;\n    }\n  }\n\n  describe(): {[key: string]: string} {\n    const res: {[key: string]: any} = {\n      'scriptTime': 'script execution time in ms, including gc and render',\n      'pureScriptTime': 'script execution time in ms, without gc nor render'\n    };\n    if (this._perfLogFeatures.render) {\n      res['renderTime'] = 'render time in ms';\n    }\n    if (this._perfLogFeatures.gc) {\n      res['gcTime'] = 'gc time in ms';\n      res['gcAmount'] = 'gc amount in kbytes';\n      res['majorGcTime'] = 'time of major gcs in ms';\n      if (this._forceGc) {\n        res['forcedGcTime'] = 'forced gc time in ms';\n        res['forcedGcAmount'] = 'forced gc amount in kbytes';\n      }\n    }\n    if (this._receivedData) {\n      res['receivedData'] = 'encoded bytes received since navigationStart';\n    }\n    if (this._requestCount) {\n      res['requestCount'] = 'count of requests sent since navigationStart';\n    }\n    if (this._captureFrames) {\n      if (!this._perfLogFeatures.frameCapture) {\n        const warningMsg = 'WARNING: Metric requested, but not supported by driver';\n        // using dot syntax for metric name to keep them grouped together in console reporter\n        res['frameTime.mean'] = warningMsg;\n        res['frameTime.worst'] = warningMsg;\n        res['frameTime.best'] = warningMsg;\n        res['frameTime.smooth'] = warningMsg;\n      } else {\n        res['frameTime.mean'] = 'mean frame time in ms (target: 16.6ms for 60fps)';\n        res['frameTime.worst'] = 'worst frame time in ms';\n        res['frameTime.best'] = 'best frame time in ms';\n        res['frameTime.smooth'] = 'percentage of frames that hit 60fps';\n      }\n    }\n    for (const name in this._microMetrics) {\n      res[name] = this._microMetrics[name];\n    }\n    return res;\n  }\n\n  beginMeasure(): Promise<any> {\n    let resultPromise = Promise.resolve(null);\n    if (this._forceGc) {\n      resultPromise = resultPromise.then((_) => this._driverExtension.gc());\n    }\n    return resultPromise.then((_) => this._beginMeasure());\n  }\n\n  endMeasure(restart: boolean): Promise<{[key: string]: number}> {\n    if (this._forceGc) {\n      return this._endPlainMeasureAndMeasureForceGc(restart);\n    } else {\n      return this._endMeasure(restart);\n    }\n  }\n\n  /** @internal */\n  private _endPlainMeasureAndMeasureForceGc(restartMeasure: boolean) {\n    return this._endMeasure(true).then((measureValues) => {\n      // disable frame capture for measurements during forced gc\n      const originalFrameCaptureValue = this._captureFrames;\n      this._captureFrames = false;\n      return this._driverExtension.gc()\n          .then((_) => this._endMeasure(restartMeasure))\n          .then((forceGcMeasureValues) => {\n            this._captureFrames = originalFrameCaptureValue;\n            measureValues['forcedGcTime'] = forceGcMeasureValues['gcTime'];\n            measureValues['forcedGcAmount'] = forceGcMeasureValues['gcAmount'];\n            return measureValues;\n          });\n    });\n  }\n\n  private _beginMeasure(): Promise<any> {\n    return this._driverExtension.timeBegin(this._markName(this._measureCount++));\n  }\n\n  private _endMeasure(restart: boolean): Promise<{[key: string]: number}> {\n    const markName = this._markName(this._measureCount - 1);\n    const nextMarkName = restart ? this._markName(this._measureCount++) : null;\n    return this._driverExtension.timeEnd(markName, nextMarkName)\n        .then((_: any) => this._readUntilEndMark(markName));\n  }\n\n  private _readUntilEndMark(\n      markName: string, loopCount: number = 0, startEvent: PerfLogEvent|null = null) {\n    if (loopCount > _MAX_RETRY_COUNT) {\n      throw new Error(`Tried too often to get the ending mark: ${loopCount}`);\n    }\n    return this._driverExtension.readPerfLog().then((events) => {\n      this._addEvents(events);\n      const result = this._aggregateEvents(this._remainingEvents, markName);\n      if (result) {\n        this._remainingEvents = events;\n        return result;\n      }\n      let resolve: (result: any) => void;\n      const promise = new Promise<{[key: string]: number}>(res => { resolve = res; });\n      this._setTimeout(() => resolve(this._readUntilEndMark(markName, loopCount + 1)), 100);\n      return promise;\n    });\n  }\n\n  private _addEvents(events: PerfLogEvent[]) {\n    let needSort = false;\n    events.forEach(event => {\n      if (event['ph'] === 'X') {\n        needSort = true;\n        const startEvent: PerfLogEvent = {};\n        const endEvent: PerfLogEvent = {};\n        for (const prop in event) {\n          startEvent[prop] = event[prop];\n          endEvent[prop] = event[prop];\n        }\n        startEvent['ph'] = 'B';\n        endEvent['ph'] = 'E';\n        endEvent['ts'] = startEvent['ts'] ! + startEvent['dur'] !;\n        this._remainingEvents.push(startEvent);\n        this._remainingEvents.push(endEvent);\n      } else {\n        this._remainingEvents.push(event);\n      }\n    });\n    if (needSort) {\n      // Need to sort because of the ph==='X' events\n      this._remainingEvents.sort((a, b) => {\n        const diff = a['ts'] ! - b['ts'] !;\n        return diff > 0 ? 1 : diff < 0 ? -1 : 0;\n      });\n    }\n  }\n\n  private _aggregateEvents(events: PerfLogEvent[], markName: string): {[key: string]: number}|null {\n    const result: {[key: string]: number} = {'scriptTime': 0, 'pureScriptTime': 0};\n    if (this._perfLogFeatures.gc) {\n      result['gcTime'] = 0;\n      result['majorGcTime'] = 0;\n      result['gcAmount'] = 0;\n    }\n    if (this._perfLogFeatures.render) {\n      result['renderTime'] = 0;\n    }\n    if (this._captureFrames) {\n      result['frameTime.mean'] = 0;\n      result['frameTime.best'] = 0;\n      result['frameTime.worst'] = 0;\n      result['frameTime.smooth'] = 0;\n    }\n    for (const name in this._microMetrics) {\n      result[name] = 0;\n    }\n    if (this._receivedData) {\n      result['receivedData'] = 0;\n    }\n    if (this._requestCount) {\n      result['requestCount'] = 0;\n    }\n\n    let markStartEvent: PerfLogEvent = null !;\n    let markEndEvent: PerfLogEvent = null !;\n    events.forEach((event) => {\n      const ph = event['ph'];\n      const name = event['name'];\n      if (ph === 'B' && name === markName) {\n        markStartEvent = event;\n      } else if (ph === 'I' && name === 'navigationStart') {\n        // if a benchmark measures reload of a page, use the last\n        // navigationStart as begin event\n        markStartEvent = event;\n      } else if (ph === 'E' && name === markName) {\n        markEndEvent = event;\n      }\n    });\n    if (!markStartEvent || !markEndEvent) {\n      // not all events have been received, no further processing for now\n      return null;\n    }\n\n    let gcTimeInScript = 0;\n    let renderTimeInScript = 0;\n\n    const frameTimestamps: number[] = [];\n    const frameTimes: number[] = [];\n    let frameCaptureStartEvent: PerfLogEvent|null = null;\n    let frameCaptureEndEvent: PerfLogEvent|null = null;\n\n    const intervalStarts: {[key: string]: PerfLogEvent} = {};\n    const intervalStartCount: {[key: string]: number} = {};\n\n    let inMeasureRange = false;\n    events.forEach((event) => {\n      const ph = event['ph'];\n      let name = event['name'] !;\n      let microIterations = 1;\n      const microIterationsMatch = name.match(_MICRO_ITERATIONS_REGEX);\n      if (microIterationsMatch) {\n        name = microIterationsMatch[1];\n        microIterations = parseInt(microIterationsMatch[2], 10);\n      }\n      if (event === markStartEvent) {\n        inMeasureRange = true;\n      } else if (event === markEndEvent) {\n        inMeasureRange = false;\n      }\n      if (!inMeasureRange || event['pid'] !== markStartEvent['pid']) {\n        return;\n      }\n\n      if (this._requestCount && name === 'sendRequest') {\n        result['requestCount'] += 1;\n      } else if (this._receivedData && name === 'receivedData' && ph === 'I') {\n        result['receivedData'] += event['args'] !['encodedDataLength'] !;\n      }\n      if (ph === 'B' && name === _MARK_NAME_FRAME_CAPTURE) {\n        if (frameCaptureStartEvent) {\n          throw new Error('can capture frames only once per benchmark run');\n        }\n        if (!this._captureFrames) {\n          throw new Error(\n              'found start event for frame capture, but frame capture was not requested in benchpress');\n        }\n        frameCaptureStartEvent = event;\n      } else if (ph === 'E' && name === _MARK_NAME_FRAME_CAPTURE) {\n        if (!frameCaptureStartEvent) {\n          throw new Error('missing start event for frame capture');\n        }\n        frameCaptureEndEvent = event;\n      }\n\n      if (ph === 'I' && frameCaptureStartEvent && !frameCaptureEndEvent && name === 'frame') {\n        frameTimestamps.push(event['ts'] !);\n        if (frameTimestamps.length >= 2) {\n          frameTimes.push(\n              frameTimestamps[frameTimestamps.length - 1] -\n              frameTimestamps[frameTimestamps.length - 2]);\n        }\n      }\n\n      if (ph === 'B') {\n        if (!intervalStarts[name]) {\n          intervalStartCount[name] = 1;\n          intervalStarts[name] = event;\n        } else {\n          intervalStartCount[name]++;\n        }\n      } else if ((ph === 'E') && intervalStarts[name]) {\n        intervalStartCount[name]--;\n        if (intervalStartCount[name] === 0) {\n          const startEvent = intervalStarts[name];\n          const duration = (event['ts'] ! - startEvent['ts'] !);\n          intervalStarts[name] = null !;\n          if (name === 'gc') {\n            result['gcTime'] += duration;\n            const amount =\n                (startEvent['args'] !['usedHeapSize'] ! - event['args'] !['usedHeapSize'] !) / 1000;\n            result['gcAmount'] += amount;\n            const majorGc = event['args'] !['majorGc'];\n            if (majorGc && majorGc) {\n              result['majorGcTime'] += duration;\n            }\n            if (intervalStarts['script']) {\n              gcTimeInScript += duration;\n            }\n          } else if (name === 'render') {\n            result['renderTime'] += duration;\n            if (intervalStarts['script']) {\n              renderTimeInScript += duration;\n            }\n          } else if (name === 'script') {\n            result['scriptTime'] += duration;\n          } else if (this._microMetrics[name]) {\n            (<any>result)[name] += duration / microIterations;\n          }\n        }\n      }\n    });\n\n    if (frameCaptureStartEvent && !frameCaptureEndEvent) {\n      throw new Error('missing end event for frame capture');\n    }\n    if (this._captureFrames && !frameCaptureStartEvent) {\n      throw new Error('frame capture requested in benchpress, but no start event was found');\n    }\n    if (frameTimes.length > 0) {\n      this._addFrameMetrics(result, frameTimes);\n    }\n    result['pureScriptTime'] = result['scriptTime'] - gcTimeInScript - renderTimeInScript;\n    return result;\n  }\n\n  private _addFrameMetrics(result: {[key: string]: number}, frameTimes: any[]) {\n    result['frameTime.mean'] = frameTimes.reduce((a, b) => a + b, 0) / frameTimes.length;\n    const firstFrame = frameTimes[0];\n    result['frameTime.worst'] = frameTimes.reduce((a, b) => a > b ? a : b, firstFrame);\n    result['frameTime.best'] = frameTimes.reduce((a, b) => a < b ? a : b, firstFrame);\n    result['frameTime.smooth'] =\n        frameTimes.filter(t => t < _FRAME_TIME_SMOOTH_THRESHOLD).length / frameTimes.length;\n  }\n\n  private _markName(index: number) { return `${_MARK_NAME_PREFIX}${index}`; }\n}\n\nconst _MICRO_ITERATIONS_REGEX = /(.+)\\*(\\d+)$/;\n\nconst _MAX_RETRY_COUNT = 20;\nconst _MARK_NAME_PREFIX = 'benchpress';\n\nconst _MARK_NAME_FRAME_CAPTURE = 'frameCapture';\n// using 17ms as a somewhat looser threshold, instead of 16.6666ms\nconst _FRAME_TIME_SMOOTH_THRESHOLD = 17;\n"]}